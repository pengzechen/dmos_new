

#ifndef __TCR_H__
#define __TCR_H__

// =====================  TCR 寄存器 ============================
// ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
// ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
// ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

/* TCR_EL1 寄存器字段宏定义 */

/* 低地址空间（TTBR0_EL1）翻译控制 */
#define TCR_T0SZ(x)   ((x) & 0x3F)         /* 低地址空间的区域大小 (6 位) */
#define TCR_IRGN0(x)  (((x) & 0x3) << 8)   /* 低地址空间的内部缓存属性 (2 位) */
#define TCR_ORGN0(x)  (((x) & 0x3) << 10)  /* 低地址空间的外部缓存属性 (2 位) */
#define TCR_SH0(x)    (((x) & 0x3) << 12)  /* 低地址空间的共享属性 (2 位) */
#define TCR_TG0(x)    (((x) & 0x3) << 14)  /* 低地址空间的翻译粒度 (2 位) */

/* 高地址空间（TTBR1_EL1）翻译控制 */
#define TCR_T1SZ(x)   (((x) & 0x3F) << 16) /* 高地址空间的区域大小 (6 位) */
#define TCR_A1        (1 << 22)            /* 选择 TTBR0_EL1 或 TTBR1_EL1 作为 ASID 选择 */
#define TCR_EPD1      (1 << 23)            /* 禁用 TTBR1_EL1 表项 */
#define TCR_IRGN1(x)  (((x) & 0x3) << 24)  /* 高地址空间的内部缓存属性 (2 位) */
#define TCR_ORGN1(x)  (((x) & 0x3) << 26)  /* 高地址空间的外部缓存属性 (2 位) */
#define TCR_SH1(x)    (((x) & 0x3) << 28)  /* 高地址空间的共享属性 (2 位) */
#define TCR_TG1(x)    (((x) & 0x3) << 30)  /* 高地址空间的翻译粒度 (2 位) */

/* 物理地址大小 */
#define TCR_IPS(x)    (((x) & 0x7) << 32)  /* 物理地址大小 (3 位) */

/* 其他控制位 */
#define TCR_AS        (1ULL << 36)         /* 地址空间 */
#define TCR_TBI0      (1ULL << 37)         /* 低地址空间的地址标签 */
#define TCR_TBI1      (1ULL << 38)         /* 高地址空间的地址标签 */

#define TCR_EL1  (TCR_T0SZ(64-48) | TCR_T1SZ(64-48) | TCR_TG0(0) | TCR_TG1(2))

/* el2 的设置可能不同 */
#define TCR_EL2  (TCR_T0SZ(64-48) | TCR_TG0(0))



#endif /* __TCR_H__ */